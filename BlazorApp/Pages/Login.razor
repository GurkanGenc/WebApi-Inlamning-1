@page "/login"

<div class="container"><h3>Login</h3></div>

<EditForm Model="model" OnSubmit="OnSubmit">
    <div class="container">
        <div class="mb-3">
            <label for="email" class="form-label">Email address</label>
            <InputText type="text" class="form-control" id="email" @bind-Value="model.Email" />
        </div>

        <div class="mb-3">
            <label for="pass" class="form-label">Password</label>
            <InputText type="password" class="form-control" id="password" @bind-Value="model.Password" />

        </div>    <button class="btn btn-success" type="submit">Log In</button>
    </div>
</EditForm>


@code {
    private LoginModel model { get; set; }

    protected override void OnInitialized()
    {
        model = new LoginModel();
    }

    private async Task OnSubmit()
    {
        // Saves a Http Response Message.
        var response = await Http.PostAsJsonAsync<LoginModel>("https://localhost:44397/api/Authentication/login", model);

        // Converts the Response Message to a string. 
        await sessionStorage.SetItemAsync<string>("auth", await response.Content.ReadAsStringAsync());

        // Means this page
        NavManager.NavigateTo("/");
    }


    public class LoginModel
    {
        //[Required]
        //[StringLength]
        public string Email { get; set; }

        public string Password { get; set; }
    }
}
